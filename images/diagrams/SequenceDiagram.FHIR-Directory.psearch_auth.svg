<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1405px" preserveAspectRatio="none" style="width:1486px;height:1405px;background:#FFFFFF;" version="1.1" viewBox="0 0 1486 1405" width="1486px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="354" x="562" y="27.9951">FHIR-VZD Authentisierung mit GesundheitsID</text><rect fill="#F5F5F5" height="1355.7109" style="stroke:#181818;stroke-width:0.5;" width="584.5" x="497" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142" x="715.75" y="55.3638">VZD-FHIR-Directory</text><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="105.5" y="741.6484"/><rect fill="#FFFFFF" height="96.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="105.5" y="806.9141"/><rect fill="#FFFFFF" height="841.3203" style="stroke:#181818;stroke-width:1.0;" width="10" x="546.5" y="198.2578"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="452.4531"/><rect fill="#FFFFFF" height="59.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="575.9844"/><rect fill="#FFFFFF" height="166.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="873.0469"/><rect fill="#FFFFFF" height="212.7344" style="stroke:#181818;stroke-width:1.0;" width="10" x="793.5" y="1126.9766"/><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1016.5" y="1222.375"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1137.5" y="275.6563"/><rect fill="#FFFFFF" height="206.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1137.5" y="399.1875"/><rect fill="#FFFFFF" height="148.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1137.5" y="688.3828"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1137.5" y="932.1797"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1374.5" y="124.8594"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1374.5" y="333.9219"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1374.5" y="510.7188"/><rect fill="none" height="798.1875" style="stroke:#000000;stroke-width:1.5;" width="1459" x="10" y="213.2578"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="968" x="491" y="237.3906"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="968" x="491" y="414.1875"/><rect fill="none" height="194.7969" style="stroke:#000000;stroke-width:1.5;" width="1197.5" x="20" y="650.1172"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="1177.5" x="30" y="703.3828"/><rect fill="none" height="163.6016" style="stroke:#000000;stroke-width:1.5;" width="1057.5" x="30" y="1184.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="110" x2="110" y1="93.7266" y2="1364.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="551" x2="551" y1="93.7266" y2="1364.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="798" x2="798" y1="93.7266" y2="1364.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1021.5" x2="1021.5" y1="93.7266" y2="1364.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1142.5" x2="1142.5" y1="93.7266" y2="1364.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1379" x2="1379" y1="93.7266" y2="1364.7109"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="40" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="47" y="82.4248">Client Versicherter</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="40" y="1363.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="47" y="1383.7061">Client Versicherter</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101" x="501" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="508" y="82.4248">Auth-Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101" x="501" y="1363.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="508" y="1383.7061">Auth-Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87" x="755" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="762" y="82.4248">FHIR-Proxy</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87" x="755" y="1363.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="762" y="1383.7061">FHIR-Proxy</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="965.5" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="972.5" y="82.4248">FHIR-Directory</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="965.5" y="1363.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="972.5" y="1383.7061">FHIR-Directory</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="1087.5" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="1094.5" y="82.4248">sektoraler IDP</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="1087.5" y="1363.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="1094.5" y="1383.7061">sektoraler IDP</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="1310" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="1317" y="82.4248">Federation Master</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="1310" y="1363.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="1317" y="1383.7061">Federation Master</text><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="105.5" y="741.6484"/><rect fill="#FFFFFF" height="96.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="105.5" y="806.9141"/><rect fill="#FFFFFF" height="841.3203" style="stroke:#181818;stroke-width:1.0;" width="10" x="546.5" y="198.2578"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="452.4531"/><rect fill="#FFFFFF" height="59.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="575.9844"/><rect fill="#FFFFFF" height="166.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="873.0469"/><rect fill="#FFFFFF" height="212.7344" style="stroke:#181818;stroke-width:1.0;" width="10" x="793.5" y="1126.9766"/><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1016.5" y="1222.375"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1137.5" y="275.6563"/><rect fill="#FFFFFF" height="206.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1137.5" y="399.1875"/><rect fill="#FFFFFF" height="148.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1137.5" y="688.3828"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1137.5" y="932.1797"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1374.5" y="124.8594"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1374.5" y="333.9219"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1374.5" y="510.7188"/><polygon fill="#181818" points="1362.5,120.8594,1372.5,124.8594,1362.5,128.8594,1366.5,124.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="551.5" x2="1368.5" y1="124.8594" y2="124.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="558.5" y="119.7935">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="592.5" y="119.7935">getEntityStatement</text><polygon fill="#181818" points="562.5,149.9922,552.5,153.9922,562.5,157.9922,558.5,153.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="556.5" x2="1378.5" y1="153.9922" y2="153.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="568.5" y="148.9263">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="602.5" y="148.9263">Response EntityStatement sekt. IDP</text><polygon fill="#181818" points="534.5,194.2578,544.5,198.2578,534.5,202.2578,538.5,198.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="110.5" x2="540.5" y1="198.2578" y2="198.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="117.5" y="185.6255">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="151.5" y="178.0591">AUTHORIZATION REQUEST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="155.5" y="193.1919">iss= URL sektoraler IDP</text><path d="M10,213.2578 L80,213.2578 L80,220.3906 L70,230.3906 L10,230.3906 L10,213.2578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="798.1875" style="stroke:#000000;stroke-width:1.5;" width="1459" x="10" y="213.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="25" y="226.3247">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="103" x="95" y="225.4683">[GesundheitsID]</text><path d="M491,237.3906 L555,237.3906 L555,244.5234 L545,254.5234 L491,254.5234 L491,237.3906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="968" x="491" y="237.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="506" y="250.4575">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="63" x="570" y="249.6011">[optional]</text><polygon fill="#181818" points="1125.5,271.6563,1135.5,275.6563,1125.5,279.6563,1129.5,275.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="556.5" x2="1131.5" y1="275.6563" y2="275.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="563.5" y="270.5903">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="597.5" y="270.5903">getEntityStatement (IDP)</text><polygon fill="#181818" points="567.5,300.7891,557.5,304.7891,567.5,308.7891,563.5,304.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="561.5" x2="1141.5" y1="304.7891" y2="304.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="573.5" y="299.7231">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="607.5" y="299.7231">EntityStatement</text><polygon fill="#181818" points="1362.5,329.9219,1372.5,333.9219,1362.5,337.9219,1366.5,333.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="556.5" x2="1368.5" y1="333.9219" y2="333.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="563.5" y="328.856">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="597.5" y="328.856">Fetch EntityStatement (IDP)</text><polygon fill="#181818" points="567.5,359.0547,557.5,363.0547,567.5,367.0547,563.5,363.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="561.5" x2="1378.5" y1="363.0547" y2="363.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="573.5" y="357.9888">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="607.5" y="357.9888">EntityStatement</text><polygon fill="#181818" points="1125.5,395.1875,1135.5,399.1875,1125.5,403.1875,1129.5,399.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="556.5" x2="1131.5" y1="399.1875" y2="399.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="563.5" y="394.1216">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="597.5" y="394.1216">AUTHORIZATION REQUEST (PAR)</text><path d="M491,414.1875 L555,414.1875 L555,421.3203 L545,431.3203 L491,431.3203 L491,414.1875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="968" x="491" y="414.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="506" y="427.2544">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="63" x="570" y="426.3979">[optional]</text><polygon fill="#181818" points="572.5,448.4531,562.5,452.4531,572.5,456.4531,568.5,452.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="566.5" x2="1136.5" y1="452.4531" y2="452.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="578.5" y="447.3872">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="612.5" y="447.3872">getEntityStatement (RP)</text><polygon fill="#181818" points="1125.5,477.5859,1135.5,481.5859,1125.5,485.5859,1129.5,481.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="556.5" x2="1131.5" y1="481.5859" y2="481.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="563.5" y="476.52">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="597.5" y="476.52">EntityStatement</text><polygon fill="#181818" points="1362.5,506.7188,1372.5,510.7188,1362.5,514.7188,1366.5,510.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1147.5" x2="1368.5" y1="510.7188" y2="510.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="1154.5" y="505.6528">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="1188.5" y="505.6528">Fetch EntityStatement (RP)</text><polygon fill="#181818" points="1158.5,535.8516,1148.5,539.8516,1158.5,543.8516,1154.5,539.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1152.5" x2="1378.5" y1="539.8516" y2="539.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="1164.5" y="534.7856">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="1198.5" y="534.7856">EntityStatement</text><polygon fill="#181818" points="572.5,571.9844,562.5,575.9844,572.5,579.9844,568.5,575.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="566.5" x2="1136.5" y1="575.9844" y2="575.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="578.5" y="570.9185">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="612.5" y="570.9185">URI-PAR</text><polygon fill="#181818" points="121.5,631.1172,111.5,635.1172,121.5,639.1172,117.5,635.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="115.5" x2="545.5" y1="635.1172" y2="635.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="127.5" y="630.0513">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="161.5" y="630.0513">AUTHORIZATION REQUEST (URI-PAR)</text><path d="M20,650.1172 L84,650.1172 L84,657.25 L74,667.25 L20,667.25 L20,650.1172 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="194.7969" style="stroke:#000000;stroke-width:1.5;" width="1197.5" x="20" y="650.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="663.1841">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="190" x="99" y="662.3276">[Implementierungsspezifisch]</text><polygon fill="#181818" points="1125.5,684.3828,1135.5,688.3828,1125.5,692.3828,1129.5,688.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="110.5" x2="1131.5" y1="688.3828" y2="688.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="117.5" y="683.3169">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="151.5" y="683.3169">AUTHORIZATION REQUEST (URI-PAR)</text><path d="M30,703.3828 L94,703.3828 L94,710.5156 L84,720.5156 L30,720.5156 L30,703.3828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="1177.5" x="30" y="703.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="716.4497">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="63" x="109" y="715.5933">[optional]</text><polygon fill="#181818" points="126.5,737.6484,116.5,741.6484,126.5,745.6484,122.5,741.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="1136.5" y1="741.6484" y2="741.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="132.5" y="736.5825">[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="166.5" y="736.5825">Login, user consent</text><polygon fill="#181818" points="1125.5,766.7813,1135.5,770.7813,1125.5,774.7813,1129.5,770.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="110.5" x2="1131.5" y1="770.7813" y2="770.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="117.5" y="765.7153">[17]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="151.5" y="765.7153">credentials, Consent</text><polygon fill="#181818" points="126.5,802.9141,116.5,806.9141,126.5,810.9141,122.5,806.9141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="1136.5" y1="806.9141" y2="806.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="132.5" y="801.8481">[18]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="166.5" y="801.8481">Redirect to redirect URL, AUTH_CODE</text><polygon fill="#181818" points="539.5,869.0469,549.5,873.0469,539.5,877.0469,543.5,873.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="115.5" x2="545.5" y1="873.0469" y2="873.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="122.5" y="867.981">[19]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="156.5" y="867.981">AUTH_CODE</text><polygon fill="#181818" points="1125.5,928.1797,1135.5,932.1797,1125.5,936.1797,1129.5,932.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="561.5" x2="1131.5" y1="932.1797" y2="932.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="568.5" y="927.1138">[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="602.5" y="927.1138">AUTH_CODE</text><polygon fill="#181818" points="572.5,957.3125,562.5,961.3125,572.5,965.3125,568.5,961.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="566.5" x2="1141.5" y1="961.3125" y2="961.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="578.5" y="956.2466">[21]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="612.5" y="956.2466">ID_TOKEN, (ACCESS_TOKEN)</text><line style="stroke:#181818;stroke-width:1.0;" x1="561.5" x2="603.5" y1="990.4453" y2="990.4453"/><line style="stroke:#181818;stroke-width:1.0;" x1="603.5" x2="603.5" y1="990.4453" y2="1003.4453"/><line style="stroke:#181818;stroke-width:1.0;" x1="562.5" x2="603.5" y1="1003.4453" y2="1003.4453"/><polygon fill="#181818" points="572.5,999.4453,562.5,1003.4453,572.5,1007.4453,568.5,1003.4453" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="568.5" y="985.3794">[22]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="602.5" y="985.3794">Erzeuge search-accesstoken</text><polygon fill="#181818" points="121.5,1035.5781,111.5,1039.5781,121.5,1043.5781,117.5,1039.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="115.5" x2="550.5" y1="1039.5781" y2="1039.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="127.5" y="1034.5122">[23]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378" x="161.5" y="1034.5122">Response AUTHORIZATION REQUEST (search-accesstoken)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1479" x="0" y="1068.1445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1479" y1="1068.1445" y2="1068.1445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1479" y1="1071.1445" y2="1071.1445"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="157" x="661" y="1057.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138" x="667" y="1073.645">...fachlicher flow...</text><polygon fill="#181818" points="781.5,1122.9766,791.5,1126.9766,781.5,1130.9766,785.5,1126.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="110.5" x2="787.5" y1="1126.9766" y2="1126.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="117.5" y="1114.3442">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="151.5" y="1106.7778">GET /psearch?... (Auth Header mit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="151.5" y="1121.9106">search-accesstoken)</text><line style="stroke:#181818;stroke-width:1.0;" x1="803.5" x2="845.5" y1="1156.1094" y2="1156.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="845.5" x2="845.5" y1="1156.1094" y2="1169.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="804.5" x2="845.5" y1="1169.1094" y2="1169.1094"/><polygon fill="#181818" points="814.5,1165.1094,804.5,1169.1094,814.5,1173.1094,810.5,1169.1094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="810.5" y="1151.0435">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="844.5" y="1151.0435">prüfe search-accesstoken</text><path d="M30,1184.1094 L94,1184.1094 L94,1191.2422 L84,1201.2422 L30,1201.2422 L30,1184.1094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="163.6016" style="stroke:#000000;stroke-width:1.5;" width="1057.5" x="30" y="1184.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45" y="1197.1763">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="188" x="109" y="1196.3198">[search-accesstoken is valid]</text><polygon fill="#181818" points="1004.5,1218.375,1014.5,1222.375,1004.5,1226.375,1008.5,1222.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="803.5" x2="1010.5" y1="1222.375" y2="1222.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="810.5" y="1217.3091">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="844.5" y="1217.3091">GET /?...</text><polygon fill="#181818" points="814.5,1262.6406,804.5,1266.6406,814.5,1270.6406,810.5,1266.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="808.5" x2="1020.5" y1="1266.6406" y2="1266.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="820.5" y="1254.0083">[27]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="854.5" y="1246.4419">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="854.5" y="1261.5747">(Result Body json)</text><polygon fill="#181818" points="121.5,1291.7734,111.5,1295.7734,121.5,1299.7734,117.5,1295.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="115.5" x2="792.5" y1="1295.7734" y2="1295.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="127.5" y="1290.7075">[28]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="161.5" y="1290.7075">HTTP 200 OK (Result Body json)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="1087.5" y1="1304.7734" y2="1304.7734"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="200" x="35" y="1314.9839">[search-accesstoken is invalid]</text><polygon fill="#181818" points="121.5,1335.7109,111.5,1339.7109,121.5,1343.7109,117.5,1339.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="115.5" x2="797.5" y1="1339.7109" y2="1339.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="127.5" y="1334.645">[29]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="161.5" y="1334.645">HTTP 401</text><!--MD5=[c02d9247ddb5b0f8301adb26b9e4a852]
@startuml
autonumber 1 1 "<b>[00]"
title "FHIR-VZD Authentisierung mit GesundheitsID"

participant VClient as "Client Versicherter"

box VZD-FHIR-Directory #WhiteSmoke
    participant "Auth-Service" as VzdAuth
    participant fp as "FHIR-Proxy"
    participant fd as "FHIR-Directory"
end box
participant sekIDP as "sektoraler IDP" 
participant "Federation Master" as fedMaster


VzdAuth->fedMaster++: getEntityStatement
fedMaster- ->VzdAuth: Response EntityStatement sekt. IDP
deactivate fedMaster

VClient->VzdAuth++: AUTHORIZATION REQUEST \n iss= URL sektoraler IDP

par GesundheitsID

alt optional
VzdAuth->sekIDP++: getEntityStatement (IDP)
sekIDP- ->VzdAuth: EntityStatement
deactivate sekIDP
VzdAuth->fedMaster++: Fetch EntityStatement (IDP)
fedMaster- ->VzdAuth: EntityStatement
deactivate fedMaster
end

VzdAuth->sekIDP++: AUTHORIZATION REQUEST (PAR)

alt optional
sekIDP->VzdAuth++: getEntityStatement (RP)
VzdAuth- ->sekIDP: EntityStatement
deactivate VzdAuth
sekIDP->fedMaster++: Fetch EntityStatement (RP)
fedMaster- ->sekIDP: EntityStatement
deactivate fedMaster
end

sekIDP- ->VzdAuth++: URI-PAR
deactivate sekIDP

VzdAuth- ->VClient: AUTHORIZATION REQUEST (URI-PAR)
deactivate VzdAuth

alt Implementierungsspezifisch
VClient->sekIDP++:  AUTHORIZATION REQUEST (URI-PAR)

alt optional
sekIDP- ->VClient++: Login, user consent
VClient->sekIDP: credentials, Consent
deactivate VClient

deactivate fedMaster
end

sekIDP- ->VClient++: Redirect to redirect URL, AUTH_CODE
deactivate sekIDP

end

VClient->VzdAuth++: AUTH_CODE
deactivate VClient
VzdAuth->sekIDP++: AUTH_CODE
sekIDP- ->VzdAuth: ID_TOKEN, (ACCESS_TOKEN)
deactivate sekIDP
VzdAuth->VzdAuth: Erzeuge search-accesstoken

end

VzdAuth- ->VClient: Response AUTHORIZATION REQUEST (search-accesstoken)
deactivate VzdAuth
deactivate VzdAuth

== ...fachlicher flow... ==

VClient -> fp: GET /psearch?... (Auth Header mit\nsearch-accesstoken)
activate fp
fp -> fp: prüfe search-accesstoken

alt search-accesstoken is valid
fp -> fd: GET /?...
activate fd
fd - -> fp: HTTP 200 OK\n(Result Body json)
deactivate fd
fp - -> VClient: HTTP 200 OK (Result Body json)
else search-accesstoken is invalid
fp - -> VClient: HTTP 401
deactivate fp
end
@enduml

PlantUML version 1.2022.13(Sat Nov 19 13:22:17 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>